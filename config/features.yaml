# Feature Flags Configuration
#
# Używane w: app/core/config.py
# Toggles dla feature flags i parametrów systemu
#
# Usage:
#   from config import features
#   if features['rag']['enabled']:
#       ...

rag:
  # Globalny toggle dla systemu RAG
  enabled: true

  # GraphRAG NODE PROPERTIES
  node_properties_enabled: true
  extract_summaries: true
  extract_key_facts: true
  relationship_confidence: true

segment_cache:
  # Feature flag: Włącz segment-first cache (zamiast per-persona RAG)
  # Benefits: 3x szybsze, 60% mniej tokenów, lepsza spójność
  # Rollback: Ustaw na False aby wrócić do starego flow
  enabled: true

  # TTL dla segment cache w Redis (dni)
  ttl_days: 7

orchestration:
  # Feature flag: Enable persona orchestration with Gemini 2.5 Pro
  # Benefits:
  #   - Długie briefe (900-1200 chars) dla każdego demographic group
  #   - Graph RAG insights (3-5 insights per group)
  #   - Segment characteristics (4-6 kluczowych cech)
  #   - Allocation reasoning (dlaczego tyle person w grupie)
  # Trade-off: ~10-20s latency z cachingiem (vs 2-5s basic generation)
  # Rollback: Ustaw na False aby wrócić do basic generation
  enabled: true

  # Orchestration timeout (seconds)
  # With Redis caching + optimized queries: should complete in 10-20s
  # Without caching (cold start): may take up to 60s
  timeout: 90  # Safety margin for Cloud Run

study_designer:
  # Feature flag: Use v2 architecture (simplified 3-node graph)
  # V2 Benefits:
  #   - 5-9 LLM calls → 1-2 calls (-80% latency reduction)
  #   - Gemini Pro dla multi-step extraction (better JSON quality)
  #   - Response caching (20-30% cache hit rate)
  #   - 35-45s average → 12-15s average
  # Trade-off: +60% cost per conversation (Gemini Pro), ale cache reduces effective cost
  # Rollback: Ustaw na False aby wrócić do v1 (old 7-node architecture)
  use_v2_architecture: true

  # V2 caching
  cache_enabled: true
  cache_ttl_seconds: 3600  # 1 hour

  # Timeouts
  api_timeout_seconds: 90  # API layer timeout
  graph_timeout_seconds: 60  # State machine timeout

performance:
  # Maksymalny czas odpowiedzi pojedynczej persony (sekundy)
  max_response_time_per_persona: 3

  # Maksymalny całkowity czas wykonania grupy fokusowej (sekundy)
  max_focus_group_time: 30

  # Próg błędu spójności (0.0-1.0)
  consistency_error_threshold: 0.05

  # Próg istotności statystycznej (p-value, domyślnie 0.05)
  statistical_significance_threshold: 0.05

  # Seed dla reproducibility (ten sam seed = te same wyniki)
  random_seed: 42
